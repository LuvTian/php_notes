<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>ajax search</title>
<style>
    body{font-family:微软雅黑;}
    table{border-collapse:collapse;}
    thead{color:red;}
    tr:hover{background:#CCFFFF;}
    td{border:1px solid blue;font-size:13px;padding:0 5px;height:50px;}
    .search{width: 250px;}
    #search{margin-bottom: 20px;}
</style>
</head>
<body>
<form>
    <input type="text" name="search" placeholder="测试搜索词：世纪城、租房、考虑" class="search">
    <input type="submit" id="search" value="搜索">
</form>

    <table class="table" border="0" cellspacing=0 cellpadding=0></table>

<!-- // 搜索功能 -->
<script src="http://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
<script>
    $(function(){

        $('#search').on('click',function(){
            $('.table').html('');
            if($('.search').val()==''){
                alert("请输入搜索词");
                return false;
            }

            $.ajax({
                url: 'search.php',
                type: 'POST',
                dataType: 'json',
                data: {
                    search:$('.search').val() //把表单数据以post方式传给后台
                }

            })
            .done(function(data) {
                    for(var a in data){
                        for(var b in data[a]){
                            if(isFinite(b)){ //后台传来的json数据没有经过处理，索引项和关联项重复，这里就判断一下，然后删除索引项
                                delete data[a][b];
                            }
                        }
                        /*document.write("<td style='border:1px solid blue;font-size:13px;padding:0 5px'>");
                        document.write(data[a]['name']);
                        document.write("</td>");
                        document.write("<td style='border:1px solid blue;font-size:13px;padding:0 5px'>");
                        document.write(data[a]['age']);
                        document.write("</td>");
                        document.write("<td style='border:1px solid blue;font-size:13px;padding:0 5px'>");
                        document.write(data[a]['tel']);
                        document.write("</td>");
                        document.write("<td style='border:1px solid blue;font-size:13px;padding:0 5px'>");
                        document.write(data[a]['note']);
                        document.write("</td>");*/

                    }

                    console.log(data);//返回处理后的json
                    if(data){
                        $('.table').append('<thead><tr><td>id</td><td>姓名</td><td>年龄</td><td>电话</td><td>描述</td></tr></thead>');
                        $.each(data,function(i,item){//动态创建一个表格并把处理后的json数据添加到里面
                            $('.table').append(
                                "<tr><td>"+item.id+ "</td>" +
                                "<td>"+item.name+ "</td>" +
                                "<td>" + item.age+ "</td>" +
                                "<td>" + item.tel + "</dt>" +
                                "<td>" + item.note+ "</td></tr>"
                            )
                        })
                    }else{
                        $('.table').html("未查询到相关内容，请更换搜索词");
                    }

            })
            .fail(function() {
                alert("error");
            });
            return false;//阻止默认提交
        });
    })
</script>

</body>
</html>

