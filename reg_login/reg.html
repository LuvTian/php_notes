<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>注册</title>
<style>
    *{margin: 0;padding: 0;}
    form{
        width: 30%;
        margin: 20px auto;
        padding: 20px 0;
        border:1px solid #ccc;
        border-radius:10px;
        text-align: center;
    }
    input{margin: 10px 0;}
</style>
</head>
<body>
    <form action="reg.php" method="post">
        用户名：<input type="text" name="uname"><span class="info"></span><br>
        密&emsp;码：<input type="password" name="upass"><br>
        <input type="submit" value="注册" id="submit">
        <p class="result"></p>
    </form>



    <script src="http://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
    <script>
        $(function(){
            // ajax验证用户名是否已经被注册
            $('input[name=uname]').blur(function() {
                $.ajax({
                    url: 'reg.php',
                    type: 'POST',
                    dataType: 'JSON',
                    data: {uname: $('input[name=uname]').val()}
                })
                .done(function(data) {
                    // console.log(data);
                    if(data!=null){
                        $('.info').text(data.username+'已经被注册')
                    }else{
                        $('.info').text('此用户名可用');

                    }
                    return false;
                })
                .fail(function(data) {
                    alert('查询失败');
                });

                return false;
            });


            // ajax注册
            $('#submit').on('click',function(){
                if($('input[name=uname]').val()==''){
                    alert('请输入用户名');
                    return false;
                }else if ($('input[name=upass]').val()=='') {
                    alert('请输入密码');
                    return false;
                }
                $.ajax({
                    url: 'reg.php',
                    type: 'POST',
                    dataType: 'JSON',
                    data: $('form').serialize(),
                })
                .done(function() {
                    $('.result').text('注册成功！')
                })
                .fail(function() {
                    console.log("error");
                });

                return false;

            })

        })
    </script>
</body>
</html>
